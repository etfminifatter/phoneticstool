# Excel单词音标生成器

## 项目概述
这是一个简单的在线工具，可以处理Excel文件中的英文单词，自动生成对应的英式和美式音标，并将结果导出为Excel格式。

## 基本需求
- 上传Excel文件，识别"词"列
- 生成英式和美式音标
- 将结果导出为Excel文件（原表格基础上新增音标列）
- 无需登录即可使用
- 简洁易用的界面设计

## 详细需求

### 1. Excel文件格式与处理逻辑
- 输入Excel文件只有一列，列名为"词"
- 每一行可能是单词、短句，可能存在大小写、标点符号、等号等
- 处理逻辑：
  - **等号截断处理**：使用`split('=')[0]`提取等号前内容（如"she's = she is" → "she's"）
  - **空白字符规范化**：移除首尾空格/换行符，将连续多个空格压缩为单个空格
  - **短语分词决策**：检测到空格时根据条件决定是否分词（存在于本地短语库或短虚词组合除外）
  - **大小写标准化**：转为小写用于查询（但保留原始大小写）
  - **特殊符号过滤**：移除不影响发音的标点，保留必要符号（如撇号）

### 2. 音标获取方式
- 优先从本地词典查询音标
- 本地查询不到时，检查缓存表
- 缓存未命中时，从远端API获取并缓存结果
- 远端API查询失败时返回"Not Found"

### 3. 界面设计
```
+-------------------------------------------+
|   Excel音标生成工具                       |
+-------------------+-----------------------+
| 上传区            | 预览区                |
|                   |                       |
| [拖拽文件到这里]  | 单词    美式   英式    |
| 或点击选择文件    |----------------       |
|                   | Hello /hə'lo/ /hɛ'ləʊ/|
+-------------------+-----------------------+
| [状态栏] 已加载：example.xlsx             |
| [下载按钮]                                |
+-------------------------------------------+
```

| 组件 | 功能说明 | 交互规则 |
| --- | --- | --- |
| 文件上传区 | 拖拽/点击上传Excel | 限制10MB以下.xlsx文件 |
| 结果预览区 | 展示前5行带音标的数据 | 高亮新增的音标列 |
| 错误提示框 | 列名错误/格式错误等 | 自动消失延时3秒 |
| 下载按钮 | 触发文件下载 | 保留原始文件名+_phonetics |

### 4. 导出格式
- 在原Excel文件基础上新增两列：英式音标和美式音标
- 保留原始数据不变

### 5. 错误处理
- 找不到音标时显示"Not Found"
- Excel格式不正确时显示错误提示

## 技术实现流程

### 单词处理流程
```
原始内容 → 检查是否含等号 → 提取等号前内容/保留原内容 → 检查是否含空格 
→ 分词处理/直接查询 → 批量查询音标 → 音标拼接
```

### 音标查询流程
```
查询请求 → 本地词典查询 → 缓存表查询 → 远程API查询 → 结果返回与缓存
```

### 界面交互流程
```
选择文件 → 格式校验 → 显示加载动画 → 展示预览 → 启用下载按钮
```

## 技术方案

### 前端技术栈
- HTML5 + CSS3 + JavaScript（纯前端实现）
- 使用原生拖拽API实现文件上传
- 使用SheetJS库处理Excel文件
- 使用原生Fetch API进行后端通信

### 后端技术选择
- 简单HTTP服务器处理API请求
- SQLite本地数据库存储单词音标词典
- 使用缓存表减少对外部API的依赖

### 关键技术点
1. **Excel文件处理**：使用SheetJS库读取和生成Excel文件
2. **音标查询**：
   - 本地词典：预先加载的常用单词音标库
   - 远程API：在本地查询失败时调用
   - 缓存机制：减少重复API调用
3. **分词处理**：对包含多个单词的短语进行智能拆分
4. **用户体验优化**：加载提示、错误处理、直观的界面

 